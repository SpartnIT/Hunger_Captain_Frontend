{"ast":null,"code":"import { addCartAction, decreaseCartAction, increaseCartAction, fetchCartAction } from \"./actions\";\nconst CARTS_KEY = 'CARTS_KEY';\nexport const fetchFromLocalStorage = () => {\n  return async dispatch => {\n    let cartsJSON = localStorage.getItem(CARTS_KEY);\n    let carts = {};\n\n    if (cartsJSON) {\n      carts = JSON.parse(cartsJSON);\n    }\n\n    const subtotal = calculateSubtotal(carts);\n    dispatch(addCartAction(prevCarts, subtotal));\n  };\n};\nexport const addCart = item => {\n  return async (dispatch, getState) => {\n    let prevCarts = getState().carts.list;\n    prevCarts[item.id] = {\n      item: item,\n      selected_count: 1\n    };\n    const subtotal = calculateSubtotal(prevCarts);\n    setToLocalStorage(prevCarts);\n    dispatch(addCartAction(prevCarts, subtotal));\n  };\n};\nexport const increaseCart = item => {\n  return async (dispatch, getState) => {\n    let prevCarts = getState().carts.list;\n    let nextSelectedCount = prevCarts[item.id].selected_count + 1;\n    prevCarts[item.id] = {\n      \"item\": item,\n      \"selected_count\": nextSelectedCount\n    };\n    const subtotal = calculateSubtotal(prevCarts);\n    setToLocalStorage(prevCarts);\n    dispatch(increaseCartAction(prevCarts, subtotal));\n  };\n};\nexport const decreaseCart = item => {\n  return async (dispatch, getState) => {\n    let prevCarts = getState().carts.list;\n    let nextSelectedCount = prevCarts[item.id].selected_count - 1;\n\n    if (nextSelectedCount > 0) {\n      prevCarts[item.id] = {\n        \"item\": item,\n        \"selected_count\": nextSelectedCount\n      };\n    } else {\n      delete prevCarts[item.id];\n    }\n\n    const subtotal = calculateSubtotal(prevCarts);\n    setToLocalStorage(prevCarts);\n    dispatch(decreaseCartAction(prevCarts, subtotal));\n  };\n};\n\nconst setToLocalStorage = carts => {\n  localStorage.setItem(CARTS_KEY, JSON.stringify(carts));\n};\n\nconst calculateSubtotal = carts => {\n  let subtotal = 0;\n\n  for (let key in carts) {\n    subtotal += Number(carts[key].item.price) * carts[key].selected_count;\n  }\n\n  return subtotal;\n};","map":{"version":3,"names":["addCartAction","decreaseCartAction","increaseCartAction","fetchCartAction","CARTS_KEY","fetchFromLocalStorage","dispatch","cartsJSON","localStorage","getItem","carts","JSON","parse","subtotal","calculateSubtotal","prevCarts","addCart","item","getState","list","id","selected_count","setToLocalStorage","increaseCart","nextSelectedCount","decreaseCart","setItem","stringify","key","Number","price"],"sources":["C:/Users/Davian/Desktop/techis-wd-forum-django-react/frontend/src/reducks/carts/operations.js"],"sourcesContent":["import { addCartAction,decreaseCartAction,increaseCartAction,fetchCartAction } from \"./actions\";\r\n\r\n\r\nconst CARTS_KEY = 'CARTS_KEY';\r\n\r\n\r\nexport const fetchFromLocalStorage = () => {\r\n    return async (dispatch) => {\r\n        let cartsJSON = localStorage.getItem(CARTS_KEY)\r\n        let carts = {};\r\n        if (cartsJSON) {\r\n            carts = JSON.parse(cartsJSON)\r\n        }\r\n        const subtotal = calculateSubtotal(carts);\r\n        dispatch(addCartAction(prevCarts,subtotal))\r\n    }\r\n}\r\n\r\nexport const addCart = (item) => {\r\n    return async(dispatch,getState) => {\r\n        let prevCarts = getState().carts.list\r\n        prevCarts[item.id] = {item:item,selected_count:1};\r\n        const subtotal = calculateSubtotal(prevCarts);\r\n        setToLocalStorage(prevCarts);\r\n        dispatch(addCartAction(prevCarts,subtotal))\r\n    }\r\n}\r\n\r\nexport const increaseCart = (item) => {\r\n    return async(dispatch,getState) => {\r\n        let prevCarts = getState().carts.list\r\n        let nextSelectedCount = prevCarts[item.id].selected_count + 1;\r\n        prevCarts[item.id] = {\"item\":item,\"selected_count\":nextSelectedCount};\r\n        const subtotal = calculateSubtotal(prevCarts);\r\n        setToLocalStorage(prevCarts);\r\n        dispatch(increaseCartAction(prevCarts,subtotal))\r\n    }\r\n}\r\n\r\nexport const decreaseCart = (item) => {\r\n    return async(dispatch,getState) => {\r\n        let prevCarts = getState().carts.list\r\n        let nextSelectedCount = prevCarts[item.id].selected_count - 1;\r\n        if (nextSelectedCount > 0) {\r\n        prevCarts[item.id] = {\"item\":item,\"selected_count\":nextSelectedCount};\r\n        } else {\r\n            delete prevCarts[item.id]\r\n        }\r\n        const subtotal = calculateSubtotal(prevCarts);\r\n        setToLocalStorage(prevCarts);\r\n        dispatch(decreaseCartAction(prevCarts,subtotal))\r\n    }\r\n}\r\n\r\n\r\nconst setToLocalStorage = (carts) => {\r\n    localStorage.setItem(CARTS_KEY,JSON.stringify(carts))\r\n}\r\n\r\nconst calculateSubtotal = (carts) => {\r\n    let subtotal = 0;\r\n    for(let key in carts) {\r\n        subtotal += (Number(carts[key].item.price) * carts[key].selected_count);\r\n    }\r\n    return subtotal\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}